
# 第四章 使用模块和元类

## 4.1 模块和元类
* 模块是扩展名为 .py 的 Python 文件，模块的名称是文件的名称，模块可以有许多函数或类
* 元类，简而言之，是创建类的蓝图。类创建一个实例，元类根据创建实例时的需求自动更改类的行为

## 4.2 如何使用模块组织代码
创建模块的一些规则：

* 保持模块名称简短，考虑不使用下划线或至少保持最小值

    ``` python
    # wrong way
    import user_card_payment
    import add_product_cart
    from user import cards_paymeng

    # right way
    import payment
    import cart
    from user.cards import payment
    ```

* 避免使用带点（ . ）、大写或一些其他特殊字符的名称，如 `credit.card.py` 的模块

    ``` python
    # wrong way
    import user.card.payment
    import USERS

    # right way
    import user_payment
    import users
    ```

* 导入模块的时候要考虑可读性
    * 不要这样
        ``` python
        from user import *

        [...]

        cart = add_to_cart(4)
        ```
        `add_to_cart()` 是 user 模块中的吗？还是内置函数？还是 `[...]` 中定义的
    
    * 应该这样
        ``` python
        from user import add_to_cart

        [...]

        cart = add_to_cart(4)
        ```
        `add_to_cart()` 会不会在 `[...]` 中重新定义了？

    * 最好这样
        ``` python
        import user

        [...]

        cart = user.add_to_cart(4)
        ```
        标识模块的来源有助于提高可读性

## 4.3 使用 \_\_init\_\_ 文件

* Python 3.3 之前，需要有一个空的 `__init__.py` 文件来将目录变成一个 Python 包，但 Python 3.3 之后不再需要了。然而，`__init__.py` 文件可以使代码更容易打包
    * purchase 包中有两个模块，分别是 cart 和 payment
    ``` 
    purchase/
    ---- cart.py
    ---- payment.py
    ---- __init__.py
    ```
    * 在 `__init__.py` 中添加
    ``` python
    from .cart import Cart
    from .payment import Payment
    ```
    * 调用时就可以在包下直接访问 Cart 和 Payment 类
    ``` python
    import purchase

    cart = purchase.Cart()
    cart.add_to_cart(cart_name, product_name)

    payment = purchase.Payment()
    payment.do_payment(user_obj, 100)
    ```
    * 如果不在 `__init__.py` 中这样操作，那么调用时必须弄清楚包中的哪些功能位于什么位置
    ``` python
    from purchase.cart import Cart
    from purchase.payment import Payment
    ```


## 4.4 以正确的方式从模块导入函数和类
